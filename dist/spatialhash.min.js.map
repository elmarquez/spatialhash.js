{"version":3,"sources":["spatialhash.js"],"names":["SpatialHash","config","self","this","INDEXING_STRATEGY","BOUNDED","UNBOUNDED","cells","cellSize","conversionFactor","envelopes","indexingStrategy","max","min","objects","Object","keys","forEach","key","getPositionHash","width","prototype","clear","getAABBCellKeys","aabb","getAABBCells","map","item","i","j","k","points","x","Math","ceil","y","z","floor","push","THREE","Vector3","getBoundedHashKey","pos","Error","getUnboundedHashKey","getCellsIntersectingAABB","intersects","cell","intersectsBox","getCellsIntersectingFrustum","frustum","getDistance","p1","p2","Array","isArray","length","sqrt","pow","distanceTo","getEntitiesIntersectingFrustum","uuid","entities","reduce","id","split","hasOwnProperty","getEntitiesIntersectingScreenRectangle","rec","Box3","setFromPoints","getPositionEnvelope","getVerticesIntersectingFrustum","insert","index","metadata","position","vertex","envelope","intersectsViewSelection","near","radius","limit","Infinity","setFromCenterAndSize","nearest","remove","indexOf","splice"],"mappings":"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","file":"spatialhash.min.js"}